<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>万字长文窥探信息收集真正的艺术 | X1ly?S</title><meta name="author" content="X1ly?S"><meta name="copyright" content="X1ly?S"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！ 收集流程概述123456789101112131415161718192021222324252627282930313233[0]自动化信息收集阶段	1.--工具自动化信息收集[1]资产发现阶段	1.--组织信息收集	2.--主域名收集	3.--子域名收集[2]资产扩展阶段	1.--端口收集	2.-">
<meta property="og:type" content="article">
<meta property="og:title" content="万字长文窥探信息收集真正的艺术">
<meta property="og:url" content="https://x1lys.github.io/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/index.html">
<meta property="og:site_name" content="X1ly?S">
<meta property="og:description" content="前言信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！ 收集流程概述123456789101112131415161718192021222324252627282930313233[0]自动化信息收集阶段	1.--工具自动化信息收集[1]资产发现阶段	1.--组织信息收集	2.--主域名收集	3.--子域名收集[2]资产扩展阶段	1.--端口收集	2.-">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://x1lys.github.io/img/1.jpg">
<meta property="article:published_time" content="2024-12-12T10:15:44.000Z">
<meta property="article:modified_time" content="2024-12-12T10:16:07.907Z">
<meta property="article:author" content="X1ly?S">
<meta property="article:tag" content="网络安全 渗透测试 web安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://x1lys.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/999.png"><link rel="canonical" href="https://x1lys.github.io/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":300,"languages":{"author":"作者: X1ly?S","link":"链接: ","source":"来源: X1ly?S","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '万字长文窥探信息收集真正的艺术',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/30.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/11.jpg" onerror="onerror=null;src='/img/47.jpg'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">109</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> 技术</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-list-alt"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-heart"></i><span> 爱好</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E5%85%AD%E7%88%BB/"><i class="fa-fw fa-solid fa-bars"></i><span> 六爻</span></a></li><li><a class="site-page child" href="/categories/%E5%86%99%E4%BD%9C/"><i class="fa-fw fas fa-pencil-alt"></i><span> 写作</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-users"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/msg/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/1.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">X1ly?S</span></a><a class="nav-page-title" href="/"><span class="site-name">万字长文窥探信息收集真正的艺术</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> 技术</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-list-alt"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-heart"></i><span> 爱好</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E5%85%AD%E7%88%BB/"><i class="fa-fw fa-solid fa-bars"></i><span> 六爻</span></a></li><li><a class="site-page child" href="/categories/%E5%86%99%E4%BD%9C/"><i class="fa-fw fas fa-pencil-alt"></i><span> 写作</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-users"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/msg/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">万字长文窥探信息收集真正的艺术</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-12T10:15:44.000Z" title="发表于 2024-12-12 18:15:44">2024-12-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-12T10:16:07.907Z" title="更新于 2024-12-12 18:16:07">2024-12-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">10.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>41分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/#post-comment"><span class="waline-comment-count" data-path="/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2024-12-12 18:16:07&quot;}" hidden></div><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！</p>
<h2 id="收集流程概述"><a href="#收集流程概述" class="headerlink" title="收集流程概述"></a>收集流程概述</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[0]自动化信息收集阶段</span><br><span class="line">	1.--工具自动化信息收集</span><br><span class="line">[1]资产发现阶段</span><br><span class="line">	1.--组织信息收集</span><br><span class="line">	2.--主域名收集</span><br><span class="line">	3.--子域名收集</span><br><span class="line">[2]资产扩展阶段</span><br><span class="line">	1.--端口收集</span><br><span class="line">	2.--C段收集</span><br><span class="line">[3]资产梳理阶段</span><br><span class="line">	1.--测活+指纹识别</span><br><span class="line">[4]自动化扫描阶段</span><br><span class="line">	1.--漏洞扫描器测试</span><br><span class="line">[5]重点目标针对收集阶段</span><br><span class="line">	1.--架构信息收集</span><br><span class="line">	2.--源码信息收集</span><br><span class="line">	3.--网站基本信息</span><br><span class="line">		(1)----语言</span><br><span class="line">		(2)----数据库</span><br><span class="line">		(3)----web容器</span><br><span class="line">		(4)----操作系统</span><br><span class="line">	4.--网站深度信息收集</span><br><span class="line">		(1)----前端源码</span><br><span class="line">		(2)----目录</span><br><span class="line">		(3)----端口</span><br><span class="line">		(4)----js接口</span><br><span class="line">		(5)----快照</span><br><span class="line">		(6)----插件</span><br><span class="line">		(7)----旁站</span><br><span class="line">	5.--网盘信息</span><br><span class="line">	6.--社工信息</span><br><span class="line">	7.--小程序信息</span><br><span class="line">	8.--APP信息</span><br></pre></td></tr></table></figure>

<blockquote>
<p>[0]自动化信息收集阶段：使用工具自动进行信息收集，与手工结合同时进行最佳</p>
</blockquote>
<h2 id="自动化信息收集"><a href="#自动化信息收集" class="headerlink" title="自动化信息收集"></a>自动化信息收集</h2><p>在手工信息收集之前，建议可以使用一下知名的自动化信息收集工具，帮助我们快速的进行大致的信息收集，也能与手工信息收集结果相互补充</p>
<p>没什么好说的，推荐几款工具，选择一两个觉得趁手的会用就行<br>我比较喜欢用ARL，尤其是它的文件泄露功能往往能帮我快速撕开口子，由于灯塔之前跑路了，所以要用第三方备用库</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Aabyss-Team/ARL">ARL</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/jf3Ho6MsB9nCxGl.png" alt="image-20241212141223251"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/0x727/ShuiZe_0x727">shuize</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/knownsec/Kunyu">kunyu</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hanc00l/nemo_go">nemo_go</a></li>
<li><a target="_blank" rel="noopener" href="https://www.scope-sentry.top/guide/y0qsb5ks/#%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2">ScopeSentry</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/zBIPwLUmFNEG1ud.png" alt="image-20241212144726000"></p>
<blockquote>
<p>[1]资产发现阶段：收集出目标主体大部分的资产</p>
</blockquote>
<h2 id="组织结构收集"><a href="#组织结构收集" class="headerlink" title="组织结构收集"></a>组织结构收集</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>组织结构收集就是摸清目标有哪些子公司，分别处于整体什么位置，股权分别占多少比重，与主公司的结构关系等等。由于小型目标结构组织简单，是单独存在的，没有收集阻止结构的必要。所以，这个组织结构的收集是针对于比较庞大的目标的，比如大型集团、企业，大型政党单位，大型高校。</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>那么为什么要收集目标的组织结构呢？以hw为例，假设目标是一个大型集团，收集目标的组织结构有以下作用：</p>
<ul>
<li><strong>更全面的收集到目标的所有子公司，从而得到更全的主域名，这意味着有更广的攻击面</strong></li>
<li><strong>摸清了组织结构，可以采用自下而上的打法：A公司防守很严，暴露面少很难突破，那么如果收集了组织结构就可以去找A公司的子公司作为突破口，因为子公司一般没有其主公司安全性高，而且子公司与主公司有些资产（比如办公环境，内部业务环境等等）很有可能处于同一个内网，于是只要拿下了子公司的权限，就有可能通过内网横向移动拿下主公司的权限，从而轻松拿下整个目标</strong></li>
<li><strong>摸清了组织结构，还可以采用自上而下的打法：如果已经拿下了A公司的权限，也收集了组织结构信息，那么还可以进一步攻击A公司的子公司。因为A公司中很有可能就保存了子公司的一些重要敏感数据，密码凭据等等，而且内网也很可能是连通的，也可以尝试内网横向移动，从而扩大渗透成果，爽拿数据分和权限分</strong></li>
</ul>
<h3 id="收集方法"><a href="#收集方法" class="headerlink" title="收集方法"></a>收集方法</h3><h4 id="股权收集法"><a href="#股权收集法" class="headerlink" title="股权收集法"></a>股权收集法</h4><p>以华为为例，使用<strong>爱企查</strong>看股权穿透图，收集子公司信息，(更具体的信息需要开会员)</p>
<p><img src="https://s2.loli.net/2024/12/12/aBCb25xILW4Ar1O.png" alt="image-20241029164603070"></p>
<p><img src="https://s2.loli.net/2024/12/12/OMjivQZ5E2JayTe.png" alt="image-20241029164721047"></p>
<p>股权占比小于50%的就不用看了，因为关联性已经不太强了</p>
<p><img src="https://s2.loli.net/2024/12/12/XIier4EA5TFgMWU.png" alt="image-20241029164918989"></p>
<p>这样我们就能摸清目标在整个主体中处于什么位置，以及与其他公司的关系，获得了更多的子公司名。接下来，只需手动筛选出所有的股权占比大于50%的子公司名字，全部记录下来存为<strong>company.txt</strong>，还有搞清楚目标在整个主体中处于什么位置，组织结构的收集就基本完成了</p>
<h4 id="关键人物收集法"><a href="#关键人物收集法" class="headerlink" title="关键人物收集法"></a>关键人物收集法</h4><p>还可以从关键人物出发，去寻找更多子公司信息</p>
<p>比如从华为的法人入手，查看他代表的公司：</p>
<p><img src="https://s2.loli.net/2024/12/12/V3sMZ5i4v9wYmAl.png" alt="image-20241029165709985"></p>
<p><img src="https://s2.loli.net/2024/12/12/y6dVvxaT5S1hjk7.png" alt="image-20241029165812138"></p>
<p>以及从华为的高管入手：</p>
<p><img src="https://s2.loli.net/2024/12/12/LfPDWyK7moUIEOi.png" alt="image-20241029165928192"></p>
<p>得到的结果能与上面提到的股权收集法互相补充</p>
<p>到此我们就得到了目标集团的所有股权占比较大的子公司名，保存为<strong>company.txt</strong>，后面有用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># company.txt </span><br><span class="line"># 为了便于演示，我就只列举几个</span><br><span class="line"></span><br><span class="line">华为技术有限公司</span><br><span class="line">华为投资控股有限公司</span><br><span class="line">深圳市华为电气股份有限公司</span><br><span class="line">深圳市华为技术软件有限公司</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><ul>
<li>爱企查：<a target="_blank" rel="noopener" href="https://aiqicha.baidu.com/">https://aiqicha.baidu.com/</a></li>
</ul>
<h2 id="主域名收集"><a href="#主域名收集" class="headerlink" title="主域名收集"></a>主域名收集</h2><p>收集主域名就是利用前面组织结构收集到的子公司名<strong>company.txt</strong> ，进一步分别收集他们公司的主域名，这是环环相扣的，只有组织结构收集收集得越全，收集到的主域名才会越多，攻击面才越广，才越有可能拿下目标</p>
<h3 id="ICP备案"><a href="#ICP备案" class="headerlink" title="ICP备案"></a>ICP备案</h3><h4 id="官网查询接口"><a href="#官网查询接口" class="headerlink" title="官网查询接口"></a>官网查询接口</h4><p>在中国想正规搭建网站都是需要ICP备案的，于是我们可以利用官方ICP备案查询公司名，得到其主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/3wG7JVtaElDenpj.png" alt="image-20241029171741485"></p>
<p>非常的多，点击详情就能看到该公司的主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/1PB7jb4aTgOJfvx.png" alt="image-20241029171830746"></p>
<p>该方法适合于子公司比较少的情况，因为该官网查询接口，有图形汉字验证码，不太好批量提取出子公司的主域名，只能手动复制下来，适合于小型目标</p>
<h4 id="第三方程序查询接口"><a href="#第三方程序查询接口" class="headerlink" title="第三方程序查询接口"></a>第三方程序查询接口</h4><p><img src="https://s2.loli.net/2024/12/12/fGdMIvOrJxtDqhC.png" alt="image-20241029172828417"></p>
<p>这个第三方程序查询接口好处是无验证码，可以批量提取出所有子公司的主域名，适用于大型目标，但是缺点是没有官网查询接口更新的快</p>
<p>使用icpsearch工具就能批量爬下来了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icpsearch -f compoany.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/heTBQqMKFwStkPW.png" alt="image-20241029173615368"></p>
<p>得到的结果再使用Sublime Text正则匹配一下域名就行了，Ctrl+F 输入正则表达式，勾选Find All选中全部，再右键复制全部</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">([a-zA-Z0-9-]+\.)+[a-zA-Z]&#123;2,&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/NgcP9YkHiJrTOfw.png" alt="image-20241029174420902"></p>
<p><img src="https://s2.loli.net/2024/12/12/VN4denwrYoS7CsI.png" alt="image-20241030000850266"></p>
<p>这样就提取出了域名</p>
<p><img src="https://s2.loli.net/2024/12/12/qxwZMye3WHEFQ6U.png" alt="image-20241030001004828"></p>
<h3 id="小蓝本"><a href="#小蓝本" class="headerlink" title="小蓝本"></a>小蓝本</h3><p>使用小蓝本也可以快速收集主域名，只不过也不能一次性的查所有子公司的主域名，不过可以写脚本爬取</p>
<p>来到知识产权，一键获取ICP备案</p>
<p><img src="https://s2.loli.net/2024/12/12/3Bvt1ZwXjx7LOyT.png" alt="image-20241030001301711"></p>
<p><img src="https://s2.loli.net/2024/12/12/MTisxb725KrOXAH.png" alt="image-20241030001320792"></p>
<p>手动复制一下，保存本地，再使用Sublime Text正则提取出主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/xgZyE6Y8GvCa5zi.png" alt="image-20241030001446026"></p>
<p><img src="https://s2.loli.net/2024/12/12/nPjYz6sE5waKJQB.png" alt="image-20241030001514457"></p>
<p>到此我们就通过<strong>company.txt</strong>收集到了很多的子公司的主域名，保存为<strong>domain.txt</strong>，后面有用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># domain.txt</span><br><span class="line">androidga.com</span><br><span class="line">www.hwtrip.com</span><br><span class="line">hwtrip.com</span><br><span class="line">www.huaweils.com</span><br><span class="line">huaweils.com</span><br><span class="line">www.smartcom.cc</span><br><span class="line">smartcom</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h3 id="工具-1"><a href="#工具-1" class="headerlink" title="工具"></a>工具</h3><ul>
<li>ICP备案官网：<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">https://beian.miit.gov.cn/</a></li>
<li>ICP第三方查询：<a target="_blank" rel="noopener" href="https://www.beianx.cn/">https://www.beianx.cn/</a></li>
<li>ICP批量爬取工具：<a target="_blank" rel="noopener" href="https://github.com/A10ha/ICPSearch">https://github.com/A10ha/ICPSearch</a></li>
<li>Sublmie Text：<a target="_blank" rel="noopener" href="https://www.sublimetext.com/">https://www.sublimetext.com/</a></li>
<li>小蓝本：<a target="_blank" rel="noopener" href="https://sou.xiaolanben.com/">https://sou.xiaolanben.com/</a></li>
</ul>
<h2 id="子域名收集"><a href="#子域名收集" class="headerlink" title="子域名收集"></a>子域名收集</h2><h3 id="网络测绘引擎"><a href="#网络测绘引擎" class="headerlink" title="网络测绘引擎"></a>网络测绘引擎</h3><ul>
<li>fofa</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain =&quot;主域名&quot; || cert=&quot;公用名&quot; || cert=&quot;组织名1&quot; ||  || cert=&quot;组织名2&quot; || cert=&quot;组织名3&quot; ......</span><br></pre></td></tr></table></figure>

<p>我习惯使用fofa查询，其他网络测绘搜索引擎也可以</p>
<p>domain是通过域名查，能查到web资产与非web资产，cert是通过证书查，只能查web资产，二者使用” || “结合拼接，会得到更多的子域名资产</p>
<h4 id="综合语法"><a href="#综合语法" class="headerlink" title="综合语法"></a>综合语法</h4><p>比如还是以华为为例：huaweiyun.com</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain=&quot;huaweiyun.com&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/Wp679cMLHQReomw.png" alt="image-20241030085729157"></p>
<p>仅仅使用<strong>domain &#x3D;”主域名”</strong> 能查到4条子域名，如果加上cert证书查询语法呢？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain=&quot;huaweiyun.com&quot; || cert=&quot;huaweiyun.com&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/wfQTW8dYvyJUjpG.png" alt="image-20241030085817666"></p>
<p>资产直接多了一倍！那么可想而知，如果使用网络测绘引擎收集资产不使用cert查询语法的话，会错过很多的隐蔽资产</p>
<p>那么到这里就结束了吗？并没有</p>
<p>刚才我们只是使用了**domain &#x3D;”主域名” || cert&#x3D;”公用名”**还没有考虑到其他公用名，和更多的组织名！</p>
<p><strong>注意！公用名大多数时候就是网站的主域名或子域名，而同一个主域名的资产可能有多个组织名，于是我们都要尽可能多的找出来</strong></p>
<p>怎么找公用名和组织名呢？我的方法是手动翻找https站点的证书</p>
<p>比如，点击查看几个https站点的证书详情</p>
<p><img src="https://s2.loli.net/2024/12/12/mYoOx5bJt2PkW18.png" alt="image-20241030090526688"></p>
<p><img src="https://s2.loli.net/2024/12/12/U4BC82dvOFYVlxE.png" alt="image-20241030090619680"></p>
<p><img src="https://s2.loli.net/2024/12/12/LHvgap6FhoYK5Vw.png" alt="image-20241030090648454"></p>
<p>这里就找到了新的公用名和组织名！</p>
<p><img src="https://s2.loli.net/2024/12/12/2wNFzqo8EU3ivtI.png" alt="image-20241030090750668"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">huaweicloud.com</span><br><span class="line">Huawei Software Technologies Co., Ltd.</span><br></pre></td></tr></table></figure>

<p>继续拼接到fofa的cert语法中去，看看会发生什么？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain=&quot;huaweiyun.com&quot; || cert=&quot;huaweicloud.com&quot; || cert=&quot;Huawei Software Technologies Co., Ltd.&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/Tf3GSIwU5eDXY6h.png" alt="image-20241030091207877"></p>
<p>好家伙直接干到了89830条！不得不说是真的很全，但是这么多资产也不方便测试，这里只是说可以用这种cert查询方式收集到更多的资产，扩大攻击面，实际肯定要根据情况而定，要学会灵活变通。像华为这种超级大型企业，资产本身就不少，所以不太适合使用证书查询，因为太多了，更多的适用于资产在几千条以内的中小型企业、政党单位、高校等等</p>
<h4 id="批量"><a href="#批量" class="headerlink" title="批量"></a>批量</h4><p>相信师傅注意到了，我们上面不是收集了大量的<strong>domain.txt</strong>吗，但是刚刚演示时只选取了其中一条来查询子域名，如何批量查询<strong>domain.txt</strong>的全部子域名呢？我是这么做的：</p>
<p>写了一个脚本，读取<strong>domain.txt</strong>，直接批量拼接成<strong>domain &#x3D;”主域名1” || cert&#x3D;”公用名1” || domain &#x3D;”主域名2” || cert&#x3D;”公用名2” || domain &#x3D;”主域名3” || cert&#x3D;”公用名3” ||……</strong>这种格式，再丢到fofa去查询</p>
<p>为什么这样拼接呢，就是因为公用名大多数时候就是其主域名或子域名，使用”||”连接就能查到更多的资产了</p>
<h5 id="脚本-join-py"><a href="#脚本-join-py" class="headerlink" title="脚本-join.py"></a>脚本-join.py</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python join.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取 domain.txt 文件并拼接数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_and_concatenate</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="comment"># 读取文件中的每一行，去掉空格和换行符</span></span><br><span class="line">            lines = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> file <span class="keyword">if</span> line.strip()]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 使用 &#x27; || &#x27; 连接每行数据</span></span><br><span class="line">        result = <span class="string">&#x27; || &#x27;</span>.join([<span class="string">f&#x27;domain=&quot;<span class="subst">&#123;line&#125;</span>&quot; || cert=&quot;<span class="subst">&#123;line&#125;</span>&quot;&#x27;</span> <span class="keyword">for</span> line <span class="keyword">in</span> lines])</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;文件 <span class="subst">&#123;file_path&#125;</span> 未找到。&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数并传入文件路径</span></span><br><span class="line">read_and_concatenate(<span class="string">&#x27;domain.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>域名太多只演示部分</li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/5cTR7GtDSqiyvIU.png" alt="image-20241030095140091"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain=&quot;www.openinula.net&quot; || cert=&quot;www.openinula.net&quot; || domain=&quot;www.huaweiirad.com&quot; || cert=&quot;www.huaweiirad.com&quot; || domain=&quot;www.bescloud.com.cn&quot; || cert=&quot;www.bescloud.com.cn&quot; || domain=&quot;www.bescloud.cn&quot; || cert=&quot;www.bescloud.cn&quot; || domain=&quot;www.gneec3.cn&quot; || cert=&quot;www.gneec3.cn&quot; || domain=&quot;www.gneec5.cn&quot; || cert=&quot;www.gneec5.cn&quot; ||domain=&quot;www.gneec4.cn&quot; || cert=&quot;www.gneec4.cn&quot; ||domain=&quot;www.appcubecloud.com.cn&quot;||cert=&quot;www.appcubecloud.com.cn&quot; || domain=&quot;www.besclouds.com.cn&quot; || cert=&quot;www.besclouds.com.cn&quot;||domain=&quot;www.besclouds.cn&quot;||cert=&quot;www.besclouds.cn&quot; || domain=&quot;www.gtscsm.com&quot; || cert=&quot;www.gtscsm.com&quot; || domain=&quot;www.appcubecloud.cn&quot; || cert=&quot;www.appcubecloud.cn&quot;|| domain=&quot;www.vrbtcloud.cn&quot; || cert=&quot;www.vrbtcloud.cn&quot;</span><br></pre></td></tr></table></figure>

<p>但是师傅也发现了这样还缺少通过组织名查询，于是我们还要手动地去翻找https站点的证书，<strong>或者再结合接下来”英文证书查询”方法</strong>，手动复制出公用名+组织名，也拼接到cert语法中。因为大量资产的公用名+组织名都是一致的，所以手动就行了</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">domain=&quot;www.openinula.net&quot; || cert=&quot;www.openinula.net&quot; || domain=&quot;www.huaweiirad.com&quot; || cert=&quot;www.huaweiirad.com&quot; || domain=&quot;www.bescloud.com.cn&quot; || cert=&quot;www.bescloud.com.cn&quot; || domain=&quot;www.bescloud.cn&quot; || cert=&quot;www.bescloud.cn&quot; || domain=&quot;www.gneec3.cn&quot; || cert=&quot;www.gneec3.cn&quot; || domain=&quot;www.gneec5.cn&quot; || cert=&quot;www.gneec5.cn&quot; ||domain=&quot;www.gneec4.cn&quot; || cert=&quot;www.gneec4.cn&quot; ||domain=&quot;www.appcubecloud.com.cn&quot;||cert=&quot;www.appcubecloud.com.cn&quot; || domain=&quot;www.besclouds.com.cn&quot; || cert=&quot;www.besclouds.com.cn&quot;||domain=&quot;www.besclouds.cn&quot;||cert=&quot;www.besclouds.cn&quot; || domain=&quot;www.gtscsm.com&quot; || cert=&quot;www.gtscsm.com&quot; || domain=&quot;www.appcubecloud.cn&quot; || cert=&quot;www.appcubecloud.cn&quot;|| domain=&quot;www.vrbtcloud.cn&quot; || cert=&quot;www.vrbtcloud.cn&quot; || cert=&quot;huaweicloud.com&quot; || cert=&quot;Huawei Software Technologies Co., Ltd.&quot; </span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/G6EfviBeJZ4U5n8.png" alt="image-20241030104500909"></p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><h5 id="all模式开启"><a href="#all模式开启" class="headerlink" title="all模式开启"></a>all模式开启</h5><p>使用网络测绘引擎，还需要注意的是，不要忘记开启all模式，因为查询结果默认情况下只有一年内的结果，开启all模式就能查到更多的资产，更有概率发现隐蔽资产！</p>
<p>但是需要开会员，呜呜贵贵~</p>
<p><img src="https://s2.loli.net/2024/12/12/rwsv5g6njlQzYmA.png" alt="image-20241030104630781"></p>
<h4 id="格式处理"><a href="#格式处理" class="headerlink" title="格式处理"></a>格式处理</h4><p>导出fofa结果时有一个问题就是资产格式有点混乱、不够统一，比如这样</p>
<p><img src="https://s2.loli.net/2024/12/12/TfapJWDS69Hxmqr.png" alt="image-20241030110434561"></p>
<p>URL列中同时有https+域名的，又有https+ip的，还有不带http协议头的纯域名与纯ip的格式，这样不便于后面分别的信息收集，因为纯域名会用来做c段整理，纯ip用来端口扫描，带协议头的URL用来测活或者爬取js，漏扫等等……于是需要处理格式，把他们分离出来</p>
<p>还是使用脚本处理</p>
<h5 id="脚本-format-py"><a href="#脚本-format-py" class="headerlink" title="脚本-format.py"></a>脚本-format.py</h5><p>输入input.txt-格式混乱的url列 ，输出<strong>subdomain-1.txt</strong>-子域名，<strong>url-1.txt</strong>-url。ip就不用分离了，fofa本身能导出格式整齐的ip列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python format.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动检测文件编码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">detect_encoding</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        result = chardet.detect(file.read())</span><br><span class="line">    <span class="keyword">return</span> result[<span class="string">&#x27;encoding&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取文件并处理内容</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_file</span>(<span class="params">input_file, subdomain_file, url_file</span>):</span><br><span class="line">    encoding = detect_encoding(input_file)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 打开input.txt文件并读取每一行</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> file:</span><br><span class="line">        lines = file.readlines()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 准备两个列表来存储不同的输出内容</span></span><br><span class="line">    subdomains = []</span><br><span class="line">    urls = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义一个正则表达式来匹配特定的IP地址URL</span></span><br><span class="line">    specific_ip_url_pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;http[s]?://127\.0\.0\.1(:\d+)?/?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理每一行数据</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="comment"># 去除两端的空格和换行符</span></span><br><span class="line">        line = line.strip()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查URL是否是特定的IP地址URL</span></span><br><span class="line">        <span class="keyword">if</span> specific_ip_url_pattern.<span class="keyword">match</span>(line):</span><br><span class="line">            <span class="comment"># 如果是，则直接写入url.txt</span></span><br><span class="line">            urls.append(line)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 检查URL是否基于IP地址，如果是则跳过</span></span><br><span class="line">            <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;http[s]?://\d&#123;1,3&#125;(\.\d&#123;1,3&#125;)&#123;3&#125;(:\d+)?/?&#x27;</span>, line):</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># 如果当前行是基于IP的URL，跳过不处理</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 检查并处理每种情况</span></span><br><span class="line">            <span class="keyword">if</span> line.startswith(<span class="string">&#x27;http://&#x27;</span>):</span><br><span class="line">                subdomains.append(line[<span class="number">7</span>:])  <span class="comment"># 从&#x27;http://&#x27;后面开始截取</span></span><br><span class="line">                urls.append(line)  <span class="comment"># 保持原样</span></span><br><span class="line">            <span class="keyword">elif</span> line.startswith(<span class="string">&#x27;https://&#x27;</span>):</span><br><span class="line">                subdomains.append(line[<span class="number">8</span>:])  <span class="comment"># 从&#x27;https://&#x27;后面开始截取</span></span><br><span class="line">                urls.append(line)  <span class="comment"># 保持原样</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                subdomains.append(line)  <span class="comment"># 没有协议头，直接使用</span></span><br><span class="line">                urls.append(<span class="string">&#x27;http://&#x27;</span> + line)  <span class="comment"># 添加&#x27;http://&#x27;</span></span><br><span class="line">                urls.append(<span class="string">&#x27;https://&#x27;</span> + line) <span class="comment"># 添加&quot;https://&quot; </span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将处理后的数据写入相应的文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(subdomain_file, <span class="string">&#x27;w&#x27;</span>, encoding=encoding) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> subdomain <span class="keyword">in</span> subdomains:</span><br><span class="line">            file.write(subdomain + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(url_file, <span class="string">&#x27;w&#x27;</span>, encoding=encoding) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">            file.write(url + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用处理函数</span></span><br><span class="line">process_file(<span class="string">&#x27;input.txt&#x27;</span>, <span class="string">&#x27;subdomain.txt&#x27;</span>, <span class="string">&#x27;url.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/2gqdPDjJLNFsBR8.png" alt="image-20241030112717560"></p>
<p><img src="https://s2.loli.net/2024/12/12/zo3AdD5gBw7s91R.png" alt="image-20241030112733870"></p>
<p><strong>还有一点需要注意，就是有些站点只能使用https访问，有些又只能使用http访问，有些都可以，而且使用http访问原本是https的站点还有可能绕过waf，于是整理格式生成url.txt时，最好把每个域名都添加上http+https，这样资产更全，但是也可根据实际情况而定，只要http或者只要https的，只需在脚本中注释即可</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查并处理每种情况</span></span><br><span class="line"><span class="keyword">if</span> line.startswith(<span class="string">&#x27;http://&#x27;</span>):</span><br><span class="line">    subdomains.append(line[<span class="number">7</span>:])  <span class="comment"># 从&#x27;http://&#x27;后面开始截取</span></span><br><span class="line">    urls.append(line)  <span class="comment"># 保持原样</span></span><br><span class="line"><span class="keyword">elif</span> line.startswith(<span class="string">&#x27;https://&#x27;</span>):</span><br><span class="line">    subdomains.append(line[<span class="number">8</span>:])  <span class="comment"># 从&#x27;https://&#x27;后面开始截取</span></span><br><span class="line">    urls.append(line)  <span class="comment"># 保持原样</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    subdomains.append(line)  <span class="comment"># 没有协议头，直接使用</span></span><br><span class="line">    urls.append(<span class="string">&#x27;http://&#x27;</span> + line)  <span class="comment"># 添加&#x27;http://&#x27;</span></span><br><span class="line">    <span class="comment">#urls.append(&#x27;https://&#x27; + line) # 添加&quot;https://&quot; </span></span><br></pre></td></tr></table></figure>

<p><strong>不过还好fofa中导出的ip格式是规范的，就不需要处理了，直接复制下来，保存为 ip-1.txt</strong></p>
<p>到此我们就通过<strong>domain.txt</strong>得到了 <strong>subdomain-1.txt</strong> <strong>url-1.txt ip-1.txt</strong>了保存备用，后面会合并去重</p>
<h3 id="英文证书查询"><a href="#英文证书查询" class="headerlink" title="英文证书查询"></a>英文证书查询</h3><p>除了fofa中的证书查询，还可以使用crt.sh查询网站查询证书为英文名的资产，这样也能找到很多隐蔽资产！二者可以相互补充，并且这种方式可以得到大量公用名、组织名，也可以手动拼接上述语法中去！</p>
<h4 id="查询方式"><a href="#查询方式" class="headerlink" title="查询方式"></a>查询方式</h4><h5 id="q模式"><a href="#q模式" class="headerlink" title="q模式"></a>q模式</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?q=huawei.com</span><br></pre></td></tr></table></figure>

<p>比较精准的模式</p>
<p><img src="https://s2.loli.net/2024/12/12/wEfxdVQ57F9srOo.png" alt="image-20241030101407640"></p>
<h5 id="o模式"><a href="#o模式" class="headerlink" title="o模式"></a>o模式</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?o=huawei</span><br></pre></td></tr></table></figure>

<p>模糊查询模式</p>
<p><img src="https://s2.loli.net/2024/12/12/Qv3jtBZproIcHfe.png" alt="image-20241030103550030"></p>
<p>o模式有些情况下查不出来</p>
<h4 id="批量-1"><a href="#批量-1" class="headerlink" title="批量"></a>批量</h4><p>还是写脚本，批量正则提取一下common name公用名，因为公用名大多数时候就是域名或子域名，于是这种方式也能直接得到许多隐蔽资产，许多挖SRC的大佬就是直接使用crt.sh开怼的！</p>
<h5 id="脚本-crt-sh-py"><a href="#脚本-crt-sh-py" class="headerlink" title="脚本-crt.sh.py"></a>脚本-crt.sh.py</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python crt.sh.py</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_unique_common_names</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 自定义 User-Agent 头</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 获取页面内容</span></span><br><span class="line">        response = requests.get(url, headers=headers)</span><br><span class="line">        response.raise_for_status()  <span class="comment"># 检查是否请求成功</span></span><br><span class="line">        html_content = response.text</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 提取 &lt;TD&gt; 标签中以 .cn, .com, .org, .net 结尾的内容</span></span><br><span class="line">        common_names = re.findall(<span class="string">r&#x27;&lt;TD.*?&gt;([^&lt;]*\.(?:cn|com|org|net))&lt;/TD&gt;&#x27;</span>, html_content, re.S)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 去重处理</span></span><br><span class="line">        unique_common_names = <span class="built_in">set</span>(common_names)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 输出提取的公用名</span></span><br><span class="line">        <span class="keyword">if</span> unique_common_names:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Extracted Unique Common Names:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> name <span class="keyword">in</span> unique_common_names:</span><br><span class="line">                <span class="built_in">print</span>(name.strip())  <span class="comment"># 去掉前后的空格</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No Common Names found.&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> requests.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error fetching URL: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数并传入 URL</span></span><br><span class="line">url = <span class="string">&quot;https://crt.sh/?q=baidu.com&quot;</span>  <span class="comment"># 替换为实际的查询目标和模式</span></span><br><span class="line">extract_unique_common_names(url)</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/cwRkmS3qoeiA7hY.png" alt="image-20241030105907553"></p>
<h4 id="格式处理-1"><a href="#格式处理-1" class="headerlink" title="格式处理"></a>格式处理</h4><p>还是如法炮制，把这些域名复制下来，使用刚才的格式处理format.txt脚本生成带有协议头的url资产和不带协议头的子域名资产</p>
<p>到此我们又得到了<strong>subdomain-2.txt url-2.txt</strong></p>
<h3 id="oneforall"><a href="#oneforall" class="headerlink" title="oneforall"></a>oneforall</h3><p>这位更是重量级，从名字都能看出来，这个工具集成了网上提到的所有收集子域名的方式，是的所有！crt.sh查找、VT查找、百度谷歌语法、各种测绘引擎，各种查询接口，子域名爆破，host碰撞，dns域传送，dns查询，子域名接管，fuzz等等一系列的方法！</p>
<p>但是如何最大化利用好oneforall呢？需要进行各种外调api配置，各种模块开启，才能发挥它的最大功效</p>
<p>也就是去config目录，把配置文件中的能配置的api（有些要收费，可以选择不配），都配置一下，各个模块启动一下</p>
<p><img src="https://s2.loli.net/2024/12/12/BQa92lfgU5JDFPq.png" alt="image-20241103171959834"></p>
<p><img src="https://s2.loli.net/2024/12/12/QoI43vZhe6EMDji.png" alt="image-20241103170421148"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python oneforall.py --target huaweiyun.com run</span><br><span class="line">python oneforall.py --targets domain.txt run</span><br></pre></td></tr></table></figure>

<h4 id="格式处理-2"><a href="#格式处理-2" class="headerlink" title="格式处理"></a>格式处理</h4><p>以huaweiyun.com单个目标做演示，实际是对整个domain.txt中的主域名批量找子域名，但是如果太多也可以自由取舍。</p>
<p>oneforall的结果就比较规范了，不需要处理了</p>
<p><img src="https://s2.loli.net/2024/12/12/mVYir9jG6PubgXJ.png" alt="image-20241103172320113"></p>
<p>到此我们就又通过<strong>domain.txt</strong>得到了 <strong>subdomain-3.txt</strong> <strong>url-2.txt ip-2.txt</strong></p>
<h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p>接下来，把<strong>subdomain-1.txt</strong> <strong>url-1.txt ip-1.txt</strong> <strong>subdomain-2.txt</strong> **url-2.txt ** <strong>subdomain-3.txt</strong> <strong>url-3.txt ip-2.txt</strong>分别合并为</p>
<p><strong>subdomain.txt</strong> <strong>url.txt ip.txt</strong> 再去重就行</p>
<p>这样在收集了子域名的同时，也收集了整理了URL和IP资产，用于接下来的信息收集</p>
<h3 id="工具-2"><a href="#工具-2" class="headerlink" title="工具"></a>工具</h3><ul>
<li>FOFA：<a target="_blank" rel="noopener" href="https://fofa.info/">https://fofa.info/</a></li>
<li>英文证书查询：<a target="_blank" rel="noopener" href="https://crt.sh/">https://crt.sh/</a></li>
<li>oneforall：<a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></li>
<li>去重：<a target="_blank" rel="noopener" href="https://www.iamwawa.cn/quchong.html">https://www.iamwawa.cn/quchong.html</a></li>
</ul>
<blockquote>
<p>[2]资产扩展阶段：进一步收集更多隐蔽的资产</p>
</blockquote>
<h2 id="端口收集"><a href="#端口收集" class="headerlink" title="端口收集"></a>端口收集</h2><p>上面收集了大量的主域名，子域名，已经得到了大量初步资产，但是我们都知道一个服务器可以开65535个端口，对于有些不富裕的目标来说，他们往往会在一个服务器上开放多个端口，部署多个web资产，于是端口收集就显得特别重要，这能帮我们进一步打开攻击面，发现更多的比较隐蔽的资产。于是我们对前面收集整理到的<strong>ip.txt</strong>进行全端口扫描！这里就体现了前面为什么要整理好格式了</p>
<p>端口扫描的话，我们使用fscan来做，同时还能进行基础的漏洞扫描和弱口令爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fscan.exe -hf ip.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/exLCi9G6V3blUoH.png" alt="image-20241204091446441"></p>
<p>扫描时间比较长，建议放在国外的VPS上后台运行完成</p>
<p>扫描完成之后，fscan的输出格式比较混乱，不便于进行数据整理，于是还可以使用下fscanoutput.py这个脚本，进行扫描结果归类整理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python fscanOutput.py result.txt</span><br></pre></td></tr></table></figure>

<h3 id="工具-3"><a href="#工具-3" class="headerlink" title="工具"></a>工具</h3><ul>
<li>fscan：<a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></li>
<li>fscanoutput：<a target="_blank" rel="noopener" href="https://github.com/ZororoZ/fscanOutput">https://github.com/ZororoZ/fscanOutput</a></li>
</ul>
<h2 id="C段收集"><a href="#C段收集" class="headerlink" title="C段收集"></a>C段收集</h2><p>但是，我们有时候也不要忘记收集，C段，为什么呢？因为很多大型目标购买ip资产时都是按照C段来买的，比如220.111.222.1&#x2F;24这个C段可能就是全部属于某一个大型目标的，同时，在一些情况下，有些ip资产不易被常规的收集方法找到，这会导致我们漏掉一些隐蔽的资产。比如有些ip资产既没有证书，也没有配置域名，那么这种情况，我们无脑地去扫描目标的几个C段，探测该C段下，有哪些ip存活，存活的ip又有哪些端口开放……这样就又有可能发现一些更加隐蔽的ip资产，从而发现更多潜在的攻击面！但是如果目标是小型目标，那么不推荐收集C段，因为在同一个C段中，属于该目标的ip资产压根就不多，很容易打偏！</p>
<p>那么怎么收集目标的C段呢？</p>
<p>推荐使用Eeyes根据目标的域名列表，整理目标的C段，这里又用到了前面收集整理的 subdomain.txt</p>
<p>该工具会优先排除架设有CDN的资产，然后再进行C段整理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Eeyes -l subdomain.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/SXrMLQCRux3OKka.png" alt="image-20241204093614077"></p>
<p>根据整理结果手动选择几个存活ip比较多的C段，保存为c.txt</p>
<p><img src="https://s2.loli.net/2024/12/12/pt9vUuXxaEbNyCo.png" alt="image-20241204094129791"></p>
<p>拿到这些C段之后，下一步干什么呢，当然是端口扫描啊，也就是与上面的ip.txt，合并为ip_c.txt 还是交给fscan全端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fscan.exe -hf ip_c.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt</span><br></pre></td></tr></table></figure>

<p>最后，再补充一点，就是有些情况下，资产严格绑定了域名，就是比如域名是test.com:8080，其ip是111.222.333.444:8080，但是访问111.222.333.444:8080是无法访问的，于是为了万无一失，还可以把subdomain.txt也加进去，进行全端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fscan.exe -hf ip_c_subdomain.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt</span><br></pre></td></tr></table></figure>

<p>等待fscan扫描完成后，就有可能发现更多的web资产，再把他们合并入url.txt中，这样操作下来，url.txt的资产就更全了！</p>
<h3 id="工具-4"><a href="#工具-4" class="headerlink" title="工具"></a>工具</h3><ul>
<li>Eeyes：<a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/Eeyes">https://github.com/EdgeSecurityTeam/Eeyes</a></li>
</ul>
<h2 id="HOST碰撞"><a href="#HOST碰撞" class="headerlink" title="HOST碰撞"></a>HOST碰撞</h2><p>当然，既然是”进一步收集更多隐蔽的资产”，那肯定少不了HOST碰撞。前面不是已经收集整理到了 subdomain.txt 以及 ip_c.txt 吗，那我们再把subdomain.txt 去批量解析一下域名，记录下无法正常解析的域名，就作为待碰撞的域名字典，ip_c.txt一般不算太多，于是可以直接全部拿去碰撞，或者手工筛选出几个也是OK的</p>
<h5 id="脚本-domain-auth-py"><a href="#脚本-domain-auth-py" class="headerlink" title="脚本-domain_auth.py"></a>脚本-domain_auth.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_domain_resolution</span>(<span class="params">domain</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 尝试获取域名对应的IP地址</span></span><br><span class="line">        ip = socket.gethostbyname(domain)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> socket.gaierror:</span><br><span class="line">        <span class="comment"># 如果发生解析错误，说明该域名无法解析</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 读取子域名文件</span></span><br><span class="line">    input_file = <span class="string">&#x27;subdomain.txt&#x27;</span></span><br><span class="line">    output_file = <span class="string">&#x27;result.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        domains = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> file.readlines()]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查每个域名的解析情况</span></span><br><span class="line">    unresolved_domains = []</span><br><span class="line">    <span class="keyword">for</span> domain <span class="keyword">in</span> domains:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> check_domain_resolution(domain):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;无法解析的域名: <span class="subst">&#123;domain&#125;</span>&quot;</span>)</span><br><span class="line">            unresolved_domains.append(domain)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将无法解析的域名写入到result.txt</span></span><br><span class="line">    <span class="keyword">if</span> unresolved_domains:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> result_file:</span><br><span class="line">            <span class="keyword">for</span> domain <span class="keyword">in</span> unresolved_domains:</span><br><span class="line">                result_file.write(<span class="string">f&quot;<span class="subst">&#123;domain&#125;</span>\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;解析异常的域名已写入 <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;所有域名均能解析&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>经过HOST碰撞后，运气好的话直接就撕开口子了，可能发现一些敏感脆弱的资产</p>
<p>具体host碰撞的原理与利用这里不展开讨论，可以看笔者的这一篇文章：<a href="https://x1lys.github.io/2024/12/07/%E5%A6%82%E4%BD%95HOST%E7%A2%B0%E6%92%9E%E6%8C%96%E6%8E%98%E9%9A%90%E8%94%BD%E8%B5%84%E4%BA%A7/">如何HOST碰撞挖掘隐蔽资产</a></p>
<h3 id="工具-5"><a href="#工具-5" class="headerlink" title="工具"></a>工具</h3><ul>
<li>HostCollision：<a target="_blank" rel="noopener" href="https://github.com/pmiaowu/HostCollision">https://github.com/pmiaowu/HostCollision</a></li>
<li>Hosts_scan：<a target="_blank" rel="noopener" href="https://github.com/fofapro/Hosts_scan">https://github.com/fofapro/Hosts_scan</a></li>
</ul>
<blockquote>
<p>[3]资产梳理阶段：接下来就行测活与指纹识别，便于我们快速梳理攻击面，发现薄弱点</p>
</blockquote>
<h2 id="测活-指纹识别"><a href="#测活-指纹识别" class="headerlink" title="测活+指纹识别"></a>测活+指纹识别</h2><p>目前我们已经得到了经过了整合的url.txt，为了更全一点，我们把之前整理的ip.txt也加入进去，加入之前，先给每一个ip加上http协议头</p>
<h5 id="脚本ipadd-py"><a href="#脚本ipadd-py" class="headerlink" title="脚本ipadd.py"></a>脚本ipadd.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开输入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> input_file:</span><br><span class="line">    <span class="comment"># 读取文件内容并按行分割</span></span><br><span class="line">    ip_addresses = input_file.read().splitlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开输出文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> output_file:</span><br><span class="line">    <span class="comment"># 遍历每个 IP 地址</span></span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> ip_addresses:</span><br><span class="line">        <span class="comment"># 添加 http:// 前缀</span></span><br><span class="line">        http_ip = <span class="string">&quot;http://&quot;</span> + ip</span><br><span class="line">        <span class="comment"># 添加 https:// 前缀</span></span><br><span class="line">        https_ip = <span class="string">&quot;https://&quot;</span> + ip</span><br><span class="line">        <span class="comment"># 将结果写入输出文件</span></span><br><span class="line">        output_file.write(http_ip + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        output_file.write(https_ip + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ipadd.py</span><br></pre></td></tr></table></figure>

<p>然后再次对url.txt进行去重，就得到了<strong>web.txt–经过了多次整理得到的最终的web总资产</strong></p>
<p>然后，下一步是什么呢？这些大量web资产不一定都可访问，不一定都是存活的，于是我们需要进行存活探测，于是使用一款指纹识别的工具，在指纹识别的同时也就做了存活探测了，而且指纹的识别也对我们快速打点发现漏洞切入点有极大的帮助，识别出指纹，我们就能从大量杂乱无章的资产中，优先地看一些历史漏洞比较多的CMS，或者OA系统的资产，这样就有可能快速发现Nday，一把梭了~</p>
<p>使用TideFInger或者Ehole做指纹识别</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TideFinger -uf web.txt -nobr -nopoc </span><br><span class="line">TideFinger -uf web.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/kfASbiWuvJPxrEF.png" alt="image-20241212103257146"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ehole.exe finger -l web.txt </span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/F2ROCZJQqbtgVwI.png" alt="image-20241204193249376"></p>
<h3 id="工具-6"><a href="#工具-6" class="headerlink" title="工具"></a>工具</h3><ul>
<li>TideFinger：<a target="_blank" rel="noopener" href="https://github.com/TideSec/TideFinger_Go">https://github.com/TideSec/TideFinger_Go</a></li>
<li>Ehole：<a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/EHole">https://github.com/EdgeSecurityTeam/EHole</a></li>
</ul>
<blockquote>
<p>[4]自动化扫描阶段：在开始对具体目标开展更详细更有针对性的信息收集前，可以先批量跑一下漏洞扫描器，虽然对一些经常被人测试的SRC目标来说，漏洞几乎无法发现漏洞了，但是不代表漏扫就没用。比如攻防演练时，漏扫还是很重要的，没有扫出nday的目标，就比较难以打穿了，只能要么0day，要么钓鱼了</p>
</blockquote>
<h2 id="自动化扫描"><a href="#自动化扫描" class="headerlink" title="自动化扫描"></a>自动化扫描</h2><p>也没啥好说的，就是用工具就行，这里还是推荐几个最常用的漏洞扫描器</p>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei">Nuclei</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nuclei.exe -<span class="built_in">list</span> test.txt -o output.txt</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://github.com/zan8in/afrog">Afrog</a></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afrog -T urls.txt</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://www.acunetix.com/">AWVS</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#批量添加目标</span></span><br><span class="line">python awvs.py </span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://github.com/XTLS/Xray-core/releases">Xray</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#批量添加目标</span></span><br><span class="line">python xray.py -r test.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爬取单个目标</span></span><br><span class="line">xray.exe webscan --basic-crawler http://xxxx.com/ --html-output  output-a.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听7777端口，与Brup联动</span></span><br><span class="line">xray.exe webscan --listen <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">7777</span> --html-output output-b.html</span><br></pre></td></tr></table></figure>

<p><strong>Goby</strong></p>
<p><img src="https://s2.loli.net/2024/12/12/QJezyWLbY6whMO4.png" alt="image-20241212160616003"></p>
<blockquote>
<p>[5]重点目标针对收集阶段：经过了前面的资产发现与扩展整理阶段，我们已经梳理出了一些重点资产，比如是经典框架系统，CMS，OA系统，有登录框，可注册，SSO系统等等……于是接下来就是对这些重点目标进行针对性的深度信息收集了。为什么把架构搜集放在最前面呢，因为假设目标使用了CDN，反向代理，负载均衡，那我们在没搞清楚架构的情况下，就去渗透测试，端口扫描，内网渗透，那将是毫无意义的或者收效甚微的</p>
</blockquote>
<h2 id="架构信息"><a href="#架构信息" class="headerlink" title="架构信息"></a>架构信息</h2><h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>反向代理是指代理服务器接收客户端请求，并将请求转发到一个或多个后端服务器上。通过使用反向代理，可以实现负载均衡、安全增强、SSL终止、缓存等功能。例如，当多个后端服务器承载高并发请求时，反向代理可以智能地分发请求，以减少单个服务器的负担，从而提升系统的性能和可用性。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>使用 <a target="_blank" rel="noopener" href="https://www.wappalyzer.com/">Wappalyzer</a> 浏览器插件可以帮助识别网站是否使用了反向代理。Wappalyzer会分析网站的架构信息，并显示使用的技术栈、服务器以及潜在的代理信息。</p>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>为了防止访问拥塞，减少主服务器的负担，多个负载均衡服务器监听公共网络接口，接收来自客户端的请求，然后将这些请求转发到内网的多个后端服务器端口。负载均衡不仅可以提高访问速度，还能增强系统的容错能力，避免某一个服务器的故障影响整个网站的可用性。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以使用 <strong>lbd</strong> 工具（Kali Linux自带）来识别负载均衡服务器。该工具通过分析目标服务器的响应特征，帮助判断是否存在负载均衡机制。</p>
<h3 id="站库分离"><a href="#站库分离" class="headerlink" title="站库分离"></a>站库分离</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>站库分离是一种将网站前端和数据库后端分离的架构设计。这样，即使攻击者成功入侵了网站服务器，仍然无法直接访问数据库中的敏感数据，因为数据库服务器是独立的。这种分离不仅增强了安全性，还使得网站的维护和扩展变得更加灵活。</p>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>为了提升访问体验，在多个地点部署CDN（内容分发网络）服务器，可以自动将用户的请求路由到离其最近的服务器节点，从而就近为用户提供服务。CDN可以有效地提高网站的加载速度和访问稳定性，尤其适用于全球范围内的用户。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以通过 <strong>多地ping</strong> 工具（<a target="_blank" rel="noopener" href="https://www.17ce.com/">17ce</a>）测试不同地理位置的延迟来识别是否使用了CDN。若目标网站使用CDN，通常在不同区域的访问速度和延迟差异较大。</p>
<p><strong>绕过方法</strong>:</p>
<ul>
<li>使用 <strong>全球ping</strong>（<a target="_blank" rel="noopener" href="https://tools.ipip.net/ping.php">ipip.net</a>）</li>
<li>从子域名入手</li>
<li>查找历史DNS解析记录（<a target="_blank" rel="noopener" href="https://site.ip138.com/">IP138</a>）</li>
<li>使用接口查询（<a target="_blank" rel="noopener" href="https://get-site-ip.com/">Get-site-ip</a>）</li>
<li>使用反向邮件</li>
<li><strong>FuckCDN</strong> 工具（<a target="_blank" rel="noopener" href="https://github.com/Tai7sy/fuckcdn">GitHub</a>）</li>
<li>使用 <strong>fofa</strong> 搜索引擎</li>
<li>利用 <strong>SSRF</strong> 漏洞</li>
<li>使用 <strong>phpinfo.php</strong> 探针</li>
</ul>
<h3 id="WAF（Web-Application-Firewall）"><a href="#WAF（Web-Application-Firewall）" class="headerlink" title="WAF（Web Application Firewall）"></a>WAF（Web Application Firewall）</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>WAF是专门用于防御HTTP请求中的恶意流量的安全防护工具。通过使用WAF，网站能够有效抵御SQL注入、跨站脚本攻击（XSS）等常见Web攻击。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以使用 <a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">wafw00f</a> 工具来识别目标网站是否使用了WAF。此外，结合视觉分析（<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/PWkqNsygi-c_S7tW1y_Hxw">看图识别</a>）也能帮助识别是否存在WAF。</p>
<blockquote>
<p>经<strong>架构信息打点</strong>后，可能会遇到绕过挑战，例如绕过CDN、WAF和反向代理等保护机制。在这时，进一步的源码信息收集变得尤为重要。若网站使用CMS，或源码泄露，渗透测试就可以直接上升为白盒测试，或者直接利用现成的漏洞进行攻击，省去了大部分的打点步骤。</p>
</blockquote>
<h2 id="源码信息"><a href="#源码信息" class="headerlink" title="源码信息"></a>源码信息</h2><h3 id="CMS（内容管理系统）"><a href="#CMS（内容管理系统）" class="headerlink" title="CMS（内容管理系统）"></a>CMS（内容管理系统）</h3><ul>
<li>可以使用工具如 <strong>云悉</strong> (<a target="_blank" rel="noopener" href="https://www.yunsee.cn/">yunsee</a>) 和 <strong>360观星</strong> (<a target="_blank" rel="noopener" href="https://fp.shuziguanxing.com/#/">360观星</a>) 来识别目标网站是否使用了特定的CMS系统。通过识别CMS类型，可以帮助渗透测试人员找到已知的漏洞和攻击路径。</li>
</ul>
<h3 id="闭源售卖"><a href="#闭源售卖" class="headerlink" title="闭源售卖"></a>闭源售卖</h3><ul>
<li>还可以通过一些渠道（如黑源码网站、Google 搜索和正规源码网站）来寻找潜在的源码泄露，尤其是在闭源项目中，源码泄露能为攻击者提供直接的攻击方式。</li>
</ul>
<h3 id="泄露"><a href="#泄露" class="headerlink" title="泄露"></a>泄露</h3><ul>
<li><strong>index of 目录遍历漏洞</strong></li>
<li><strong>githack</strong> (<a target="_blank" rel="noopener" href="https://github.com/lijiejie/GitHack">GitHack</a>)</li>
<li><strong>svnhack</strong> (<a target="_blank" rel="noopener" href="https://github.com/callmefeifei/SvnHack">SvnHack</a>)</li>
<li><strong>ds_store</strong> (<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_store_exp">ds_store_exp</a>)</li>
<li><strong>GitHub泄露</strong></li>
<li><strong>网盘泄露</strong></li>
</ul>
<blockquote>
<p>经<strong>源码信息打点</strong>后，若未能收获有价值的信息，接下来只能进行黑盒测试，进一步搜集网站的基本信息。</p>
</blockquote>
<h2 id="网站基本信息"><a href="#网站基本信息" class="headerlink" title="网站基本信息"></a>网站基本信息</h2><h3 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h3><ul>
<li>可以使用 <strong>Wappalyzer</strong> 工具分析网站所使用的编程语言。</li>
</ul>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ul>
<li>使用 <strong>Wappalyzer</strong> 或 <strong>fofa</strong> 进行数据库类型的识别。</li>
</ul>
<h3 id="web容器"><a href="#web容器" class="headerlink" title="web容器"></a>web容器</h3><ul>
<li>同样，<strong>Wappalyzer</strong> 和 <strong>fofa</strong> 可以帮助识别网站使用的Web容器（如Apache、Nginx等）。</li>
</ul>
<h3 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h3><ul>
<li>可以通过对目标服务器进行大小写测试和Ping TTL值分析，间接推测目标服务器使用的操作系统。</li>
</ul>
<blockquote>
<p>经<strong>网站基本信息打点</strong>后，已经掌握了大部分网站的构成信息。接下来可以进入更深层次的信息挖掘。</p>
</blockquote>
<h2 id="网站深度信息"><a href="#网站深度信息" class="headerlink" title="网站深度信息"></a>网站深度信息</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><strong>fuff</strong> (<a target="_blank" rel="noopener" href="https://github.com/ffuf/ffuf">GitHub</a>)</li>
<li><strong>7kbscan</strong> (<a target="_blank" rel="noopener" href="https://github.com/7kbstorm/7kbscan-WebPathBrute">7kbscan-WebPathBrute</a>)</li>
<li><strong>dirsearch</strong>（Kali自带）</li>
</ul>
<p>强烈推荐 FUFF 简直是FUZZ神器！</p>
<h3 id="JS接口"><a href="#JS接口" class="headerlink" title="JS接口"></a>JS接口</h3><p>进入API测试</p>
<p>本地浏览器控制台一键下载网站js文件的脚本</p>
<h5 id="downloadjs-py"><a href="#downloadjs-py" class="headerlink" title="downloadjs.py"></a>downloadjs.py</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Function to download a file</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">downloadFile</span>(<span class="params">filename, content</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([content], &#123; <span class="attr">type</span>: <span class="string">&#x27;application/javascript&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    link.<span class="property">href</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(blob);</span><br><span class="line">    link.<span class="property">download</span> = filename;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link);</span><br><span class="line">    link.<span class="title function_">click</span>();</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function to fetch external JS file and download it</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchAndDownload</span>(<span class="params">url, defaultFilename</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">        <span class="keyword">const</span> content = <span class="keyword">await</span> response.<span class="title function_">text</span>();</span><br><span class="line">        <span class="keyword">const</span> filename = url.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">pop</span>() || defaultFilename;</span><br><span class="line">        <span class="title function_">downloadFile</span>(filename, content);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Downloaded external JS file: <span class="subst">$&#123;filename&#125;</span>`</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Failed to download <span class="subst">$&#123;url&#125;</span>: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function to download all JavaScript code found in the document</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">downloadAllJS</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Collect all &lt;script&gt; elements in the document</span></span><br><span class="line">    <span class="keyword">const</span> scripts = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;script&#x27;</span>));</span><br><span class="line">    <span class="keyword">let</span> inlineCounter = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> script <span class="keyword">of</span> scripts) &#123;</span><br><span class="line">        <span class="keyword">if</span> (script.<span class="property">src</span>) &#123;</span><br><span class="line">            <span class="comment">// Case 2: External JS file</span></span><br><span class="line">            <span class="keyword">await</span> <span class="title function_">fetchAndDownload</span>(script.<span class="property">src</span>, <span class="string">`external-script-<span class="subst">$&#123;inlineCounter&#125;</span>.js`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (script.<span class="property">textContent</span>) &#123;</span><br><span class="line">            <span class="comment">// Case 1 &amp; 3: Inline JS code (could include Webpack bundled code)</span></span><br><span class="line">            <span class="keyword">const</span> filename = <span class="string">`inline-script-<span class="subst">$&#123;inlineCounter&#125;</span>.js`</span>;</span><br><span class="line">            <span class="title function_">downloadFile</span>(filename, script.<span class="property">textContent</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Downloaded inline JS as: <span class="subst">$&#123;filename&#125;</span>`</span>);</span><br><span class="line">            inlineCounter++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Run the function to download all JS files</span></span><br><span class="line"><span class="title function_">downloadAllJS</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>提取js接口的脚本</p>
<h5 id="findapi-py"><a href="#findapi-py" class="headerlink" title="findapi.py"></a>findapi.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">fileurl = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据传入的文件名确定目录名</span></span><br><span class="line">filemkdir = fileurl.split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保目录存在</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filemkdir):</span><br><span class="line">    os.makedirs(filemkdir)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取路径</span></span><br><span class="line">paths = []</span><br><span class="line"><span class="keyword">for</span> dirpath, dirnames, filenames <span class="keyword">in</span> os.walk(filemkdir):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> filenames:</span><br><span class="line">        file_path = os.path.join(dirpath, file)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;gb18030&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f2:</span><br><span class="line">                    line = line.strip(<span class="string">&#x27;\n&#x27;</span>).strip(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">                    p = re.findall(<span class="string">r&#x27;&#x27;&#x27;([&#x27;&quot;]\/[^][^&gt;&lt; \)\(\&#123;\&#125;]*?[&#x27;&quot;])&#x27;&#x27;&#x27;</span>, line)</span><br><span class="line">                    <span class="keyword">if</span> p:</span><br><span class="line">                        <span class="keyword">for</span> path <span class="keyword">in</span> p:</span><br><span class="line">                            path = path.replace(<span class="string">&#x27;:&quot;&#x27;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">                            paths.append(file + <span class="string">&quot;---&quot;</span> + path)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;File not found: <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error reading file <span class="subst">&#123;file_path&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入提取到的路径</span></span><br><span class="line">output_file = fileurl + <span class="string">&#x27;_path.txt&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;a+&quot;</span>, encoding=<span class="string">&#x27;gb18030&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> output:</span><br><span class="line">    <span class="keyword">for</span> var <span class="keyword">in</span> <span class="built_in">sorted</span>(<span class="built_in">set</span>(paths)):</span><br><span class="line">        output.write(var + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>JSfinder</strong></li>
<li><strong>packer-fuzzer</strong></li>
<li><strong>URLfinder</strong></li>
</ul>
<h3 id="快照"><a href="#快照" class="headerlink" title="快照"></a>快照</h3><ul>
<li><strong>网站时光机</strong> (<a target="_blank" rel="noopener" href="https://web.archive.org/">Wayback Machine</a>)</li>
</ul>
<h3 id="插件信息"><a href="#插件信息" class="headerlink" title="插件信息"></a>插件信息</h3><ul>
<li><strong>Wappalyzer</strong> 可以帮助识别网站中所用的插件信息。</li>
</ul>
<h3 id="第三方接口信息"><a href="#第三方接口信息" class="headerlink" title="第三方接口信息"></a>第三方接口信息</h3><ul>
<li><strong>Wappalyzer</strong> 可以识别第三方接口信息，例如支付接口、社交登录等。</li>
</ul>
<h3 id="旁站"><a href="#旁站" class="headerlink" title="旁站"></a>旁站</h3><ul>
<li>使用 <a target="_blank" rel="noopener" href="https://www.webscan.cc/">旁站</a> 工具分析潜在的旁站资源。</li>
</ul>
<h3 id="端口服务"><a href="#端口服务" class="headerlink" title="端口服务"></a>端口服务</h3><ul>
<li><strong>nmap</strong>（Kali自带）可以扫描网站开放的端口，并进一步识别服务信息。</li>
<li><strong>railgun</strong>（推荐，速度快）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>端口号</strong></th>
<th align="center"><strong>服务</strong></th>
<th><strong>攻击方式</strong></th>
<th><strong>常见漏洞</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>21</strong></td>
<td align="center">FTP</td>
<td>弱口令爆破、匿名登录、目录遍历</td>
<td>未授权访问、FTP暴露敏感文件</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td align="center">SSH</td>
<td>弱口令攻击、公私钥猜测、利用旧版本漏洞</td>
<td>CVE-2018-15473 (用户名枚举漏洞)</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td align="center">Telnet</td>
<td>弱口令爆破、明文通信窃听</td>
<td>未授权访问、会话劫持</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td align="center">SMTP</td>
<td>邮件伪造、开放中继测试</td>
<td>未授权中继、CVE-2015-0235 (GHOST 漏洞)</td>
</tr>
<tr>
<td><strong>53</strong></td>
<td align="center">DNS</td>
<td>DNS 缓存中毒、域传送漏洞</td>
<td>DNS 放大攻击、未授权域传送</td>
</tr>
<tr>
<td><strong>80</strong></td>
<td align="center">HTTP</td>
<td>SQL 注入、XSS、CSRF、路径穿越</td>
<td>Web 应用漏洞，如 SQLi、CVE-2021-12345（假设 Web 服务漏洞）</td>
</tr>
<tr>
<td><strong>110</strong></td>
<td align="center">POP3</td>
<td>弱口令攻击、邮件劫持</td>
<td>未授权访问、明文传输</td>
</tr>
<tr>
<td><strong>143</strong></td>
<td align="center">IMAP</td>
<td>邮件劫持、弱口令攻击</td>
<td>未授权访问</td>
</tr>
<tr>
<td><strong>443</strong></td>
<td align="center">HTTPS</td>
<td>SSL&#x2F;TLS 漏洞利用 (如 Heartbleed)、中间人攻击</td>
<td>Heartbleed (CVE-2014-0160)</td>
</tr>
<tr>
<td><strong>3306</strong></td>
<td align="center">MySQL</td>
<td>弱口令攻击、SQL 注入</td>
<td>未授权访问、CVE-2012-2122 (MySQL 身份验证绕过漏洞)</td>
</tr>
<tr>
<td><strong>3389</strong></td>
<td align="center">RDP</td>
<td>弱口令爆破、会话劫持、远程桌面协议利用</td>
<td>CVE-2019-0708 (BlueKeep)</td>
</tr>
<tr>
<td><strong>6379</strong></td>
<td align="center">Redis</td>
<td>未授权访问、配置文件写入攻击</td>
<td>未授权访问，RCE（写 SSH 公钥）</td>
</tr>
<tr>
<td><strong>8080</strong></td>
<td align="center">HTTP Proxy&#x2F;Tomcat</td>
<td>未授权访问、弱口令爆破、路径穿越</td>
<td>Apache Tomcat CVE-2017-12615 (PUT 文件上传漏洞)</td>
</tr>
<tr>
<td><strong>445</strong></td>
<td align="center">SMB</td>
<td>SMB 漏洞利用 (如 EternalBlue)、弱口令攻击</td>
<td>EternalBlue (CVE-2017-0144)、SMBRelay</td>
</tr>
<tr>
<td><strong>135</strong></td>
<td align="center">RPC&#x2F;DCOM</td>
<td>RPC 漏洞利用</td>
<td>CVE-2003-0352 (MS03-026 RPC 漏洞)</td>
</tr>
<tr>
<td><strong>1433</strong></td>
<td align="center">MSSQL</td>
<td>弱口令攻击、数据库注入</td>
<td>未授权访问，CVE-2019-1068 (SQL Server RCE)</td>
</tr>
<tr>
<td><strong>1521</strong></td>
<td align="center">Oracle DB</td>
<td>弱口令爆破、TNS 协议漏洞利用</td>
<td>CVE-2012-1675 (TNS Listener 泄漏漏洞)</td>
</tr>
<tr>
<td><strong>2049</strong></td>
<td align="center">NFS</td>
<td>未授权访问、敏感数据读取</td>
<td>NFS 配置错误，导致敏感数据暴露</td>
</tr>
<tr>
<td><strong>5060</strong></td>
<td align="center">SIP</td>
<td>SIP 协议劫持、放大攻击</td>
<td>未授权访问，SIP 劫持导致话费损失</td>
</tr>
<tr>
<td><strong>11211</strong></td>
<td align="center">Memcached</td>
<td>Memcached 放大攻击</td>
<td>Memcached 未授权访问导致流量放大攻击</td>
</tr>
</tbody></table>
<blockquote>
<p>经<strong>网站具体信息打点后</strong>，基本上已经掌握了大部分的信息。若幸运的话，可能已经发现了漏洞，或者找到了攻击路径。如果还没有突破，可以考虑社工信息收集，但其成功几率相对较小。</p>
</blockquote>
<h2 id="网盘信息"><a href="#网盘信息" class="headerlink" title="网盘信息"></a>网盘信息</h2><p>有时候网盘信息也有可能泄露敏感信息……</p>
<p>这里我把github也归类为”网盘”</p>
<ul>
<li>Github语法</li>
</ul>
<p>利用Github语法检索敏感信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:name <span class="built_in">test</span>			  <span class="comment">#仓库标题搜索含有关键字</span></span><br><span class="line"><span class="keyword">in</span>:descripton <span class="built_in">test</span>         <span class="comment">#仓库描述搜索含有关键字</span></span><br><span class="line"><span class="keyword">in</span>:readme <span class="built_in">test</span>             <span class="comment">#Readme文件搜素含有关键字</span></span><br><span class="line">stars:&gt;3000 <span class="built_in">test</span>           <span class="comment">#stars数量大于3000的搜索关键字</span></span><br><span class="line">stars:1000..3000 <span class="built_in">test</span>      <span class="comment">#stars数量大于1000小于3000的搜索关键字</span></span><br><span class="line">forks:&gt;1000 <span class="built_in">test</span>           <span class="comment">#forks数量大于1000的搜索关键字</span></span><br><span class="line">forks:1000..3000 <span class="built_in">test</span>      <span class="comment">#forks数量大于1000小于3000的搜索关键字</span></span><br><span class="line">size:&gt;=5000 <span class="built_in">test</span>           <span class="comment">#指定仓库大于5000k(5M)的搜索关键字</span></span><br><span class="line">pushed:&gt;2019-02-12 <span class="built_in">test</span>    <span class="comment">#发布时间大于2019-02-12的搜索关键字</span></span><br><span class="line">created:&gt;2019-02-12 <span class="built_in">test</span>   <span class="comment">#创建时间大于2019-02-12的搜索关键字</span></span><br><span class="line">user:<span class="built_in">test</span>                  <span class="comment">#用户名搜素</span></span><br><span class="line">license:apache-2.0 <span class="built_in">test</span>    <span class="comment">#明确仓库的 LICENSE 搜索关键字</span></span><br><span class="line">language:java <span class="built_in">test</span>         <span class="comment">#在java语言的代码中搜索关键字</span></span><br><span class="line">user:<span class="built_in">test</span> <span class="keyword">in</span>:name <span class="built_in">test</span>     <span class="comment">#组合搜索,用户名test的标题含有test的</span></span><br><span class="line"></span><br><span class="line">site:Github.com smtp</span><br><span class="line">site:Github.com smtp @qq.com</span><br><span class="line">site:Github.com smtp @126.com</span><br><span class="line">site:Github.com smtp @163.com</span><br><span class="line">site:Github.com smtp @sina.com.cn</span><br><span class="line">site:Github.com smtp password</span><br><span class="line">site:Github.com String password smtp</span><br><span class="line">site:Github.com smtp @baidu.com</span><br><span class="line"></span><br><span class="line">site:Github.com sa password</span><br><span class="line">site:Github.com root password</span><br><span class="line">site:Github.com User ID=’sa’;Password</span><br><span class="line">site:Github.com inurl:sql</span><br><span class="line"></span><br><span class="line">site:Github.com svn</span><br><span class="line">site:Github.com svn username</span><br><span class="line">site:Github.com svn password</span><br><span class="line">site:Github.com svn username password</span><br><span class="line"></span><br><span class="line">site:Github.com password</span><br><span class="line">site:Github.com ftp ftppassword</span><br><span class="line">site:Github.com 密码</span><br><span class="line">site:Github.com 内部</span><br></pre></td></tr></table></figure>

<p>Github监控</p>
<ul>
<li>云绘监控：<a target="_blank" rel="noopener" href="https://github.yhuisec.com/">https://github.yhuisec.com/</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/07/o9HFcvJO8BbWf36.png" alt="img"></p>
<ul>
<li>凌风云</li>
<li>gitlab</li>
<li>码云</li>
<li>语雀</li>
<li>其他网盘</li>
</ul>
<h3 id="工具-7"><a href="#工具-7" class="headerlink" title="工具"></a>工具</h3><ul>
<li>gitdorks_go：<a target="_blank" rel="noopener" href="https://github.com/damit5/gitdorks_go">https://github.com/damit5/gitdorks_go</a></li>
<li>GitDorker：<a target="_blank" rel="noopener" href="https://github.com/obheda12/GitDorker">https://github.com/obheda12/GitDorker</a></li>
</ul>
<h2 id="社工信息"><a href="#社工信息" class="headerlink" title="社工信息"></a>社工信息</h2><p>社工信息收集主要依赖人工去查找，目标是找出与目标相关的域名服务商、服务器供应商、网站管理员和开发人员等信息。</p>
<p>善用：</p>
<ul>
<li>goole语法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">PHP</span>后缀参数</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:baidu.<span class="property">com</span> <span class="attr">ext</span>:php <span class="attr">inurl</span>:?</span><br><span class="line">openbugbounty关于该域名的报告</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:openbugbounty.<span class="property">org</span> <span class="attr">inurl</span>:reports <span class="attr">intext</span>:<span class="string">&quot;baidu.com&quot;</span></span><br><span class="line">敏感信息后缀</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:<span class="string">&quot;baidu.com&quot;</span> <span class="attr">ext</span>:log | <span class="attr">ext</span>:txt | <span class="attr">ext</span>:conf | <span class="attr">ext</span>:cnf | <span class="attr">ext</span>:ini | <span class="attr">ext</span>:env | <span class="attr">ext</span>:sh | <span class="attr">ext</span>:bak | <span class="attr">ext</span>:backup | <span class="attr">ext</span>:swp | <span class="attr">ext</span>:old | <span class="attr">ext</span>:~ | <span class="attr">ext</span>:git | <span class="attr">ext</span>:svn | <span class="attr">ext</span>:htpasswd | <span class="attr">ext</span>:htaccess</span><br><span class="line">易受<span class="variable constant_">XSS</span>攻击的参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:q= | <span class="attr">inurl</span>:s= | <span class="attr">inurl</span>:search= | <span class="attr">inurl</span>:query= | <span class="attr">inurl</span>:keyword= | <span class="attr">inurl</span>:lang= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line">开放重定向参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:url= | <span class="attr">inurl</span>:<span class="keyword">return</span>= | <span class="attr">inurl</span>:next= | <span class="attr">inurl</span>:redirect= | <span class="attr">inurl</span>:redir= | <span class="attr">inurl</span>:ret= | <span class="attr">inurl</span>:r2= | <span class="attr">inurl</span>:page= <span class="attr">inurl</span>:&amp; <span class="attr">inurl</span>:http <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line">sql报错参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:id= | <span class="attr">inurl</span>:pid= | <span class="attr">inurl</span>:category= | <span class="attr">inurl</span>:cat= | <span class="attr">inurl</span>:action= | <span class="attr">inurl</span>:sid= | <span class="attr">inurl</span>:dir= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line"><span class="variable constant_">SSRF</span>易发参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:http | <span class="attr">inurl</span>:url= | <span class="attr">inurl</span>:path= | <span class="attr">inurl</span>:dest= | <span class="attr">inurl</span>:html= | <span class="attr">inurl</span>:data= | <span class="attr">inurl</span>:domain= | <span class="attr">inurl</span>:page= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line"><span class="variable constant_">LFI</span>常见参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:include | <span class="attr">inurl</span>:dir | <span class="attr">inurl</span>:detail= | <span class="attr">inurl</span>:file= | <span class="attr">inurl</span>:folder= | <span class="attr">inurl</span>:inc= | <span class="attr">inurl</span>:locate= | <span class="attr">inurl</span>:doc= | <span class="attr">inurl</span>:conf= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line"><span class="variable constant_">RCE</span>常见参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:cmd | <span class="attr">inurl</span>:exec= | <span class="attr">inurl</span>:query= | <span class="attr">inurl</span>:code= | <span class="attr">inurl</span>:<span class="keyword">do</span>= | <span class="attr">inurl</span>:run= | <span class="attr">inurl</span>:read= | <span class="attr">inurl</span>:ping= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line">敏感关键字</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:config | <span class="attr">inurl</span>:env | <span class="attr">inurl</span>:setting | <span class="attr">inurl</span>:backup | <span class="attr">inurl</span>:admin | <span class="attr">inurl</span>:php <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line">敏感参数</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:email= | <span class="attr">inurl</span>:phone= | <span class="attr">inurl</span>:password= | <span class="attr">inurl</span>:secret= <span class="attr">inurl</span>:&amp; <span class="attr">site</span>:baidu.<span class="property">com</span></span><br><span class="line"><span class="variable constant_">API</span>文档</span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:apidocs | <span class="attr">inurl</span>:api-docs | <span class="attr">inurl</span>:swagger | <span class="attr">inurl</span>:api-explorer <span class="attr">site</span>:<span class="string">&quot;baidu.com&quot;</span></span><br><span class="line">代码泄露</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:pastebin.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:jsfiddle.<span class="property">net</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:codebeautify.<span class="property">org</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:codepen.<span class="property">io</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line">云存储</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:s3.<span class="property">amazonaws</span>.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:blob.<span class="property">core</span>.<span class="property">windows</span>.<span class="property">net</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:googleapis.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:drive.<span class="property">google</span>.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:dev.<span class="property">azure</span>.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:onedrive.<span class="property">live</span>.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:digitaloceanspaces.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:sharepoint.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:s3-external-<span class="number">1.</span>amazonaws.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:s3.<span class="property">dualstack</span>.<span class="property">us</span>-east-<span class="number">1.</span>amazonaws.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:dropbox.<span class="property">com</span>/s <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:box.<span class="property">com</span>/s <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="attr">site</span>:docs.<span class="property">google</span>.<span class="property">com</span> <span class="attr">inurl</span>:<span class="string">&quot;/d/&quot;</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="title class_">JFrog</span> 软件工件管理工具</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:jfrog.<span class="property">io</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line"><span class="title class_">Firebase</span></span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:firebaseio.<span class="property">com</span> <span class="string">&quot;baidu.com&quot;</span></span><br><span class="line">文件上传点</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:baidu.<span class="property">com</span> ”choose file”</span><br><span class="line">漏洞赏金计划和漏洞披露计划</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;submit vulnerability report&quot;</span> | <span class="string">&quot;powered by bugcrowd&quot;</span> | <span class="string">&quot;powered by hackerone&quot;</span></span><br><span class="line"><span class="attr">site</span>:*/security.<span class="property">txt</span> <span class="string">&quot;bounty&quot;</span></span><br><span class="line"><span class="title class_">Apache</span>服务器状态暴露</span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:*/server-status apache</span><br><span class="line"><span class="title class_">WordPress</span></span><br><span class="line"></span><br><span class="line"><span class="attr">inurl</span>:<span class="regexp">/wp-admin/</span>admin-ajax.<span class="property">php</span></span><br><span class="line"><span class="title class_">Drupal</span></span><br><span class="line"></span><br><span class="line"><span class="attr">intext</span>:<span class="string">&quot;Powered by&quot;</span> &amp; <span class="attr">intext</span>:<span class="title class_">Drupal</span> &amp; <span class="attr">inurl</span>:user</span><br><span class="line"><span class="title class_">Joomla</span></span><br><span class="line"></span><br><span class="line"><span class="attr">site</span>:*<span class="regexp">/joomla/</span>login</span><br></pre></td></tr></table></figure>

<ul>
<li>百度 </li>
<li>各种社交媒体 </li>
<li>甚至是可联网的搜索的AI</li>
</ul>
<blockquote>
<p>网站资产信息打点到此为止，但我们仍可以对目标旗下的小程序、APP进行进一步的信息搜集。</p>
</blockquote>
<h2 id="小程序信息"><a href="#小程序信息" class="headerlink" title="小程序信息"></a>小程序信息</h2><p>小程序和APP的信息收集方法不多赘述，简单提及如下：</p>
<ul>
<li>使用安卓模拟器或 <strong>Burp Suite</strong> 等抓包工具分析出Web资产，然后重复上述信息收集步骤。</li>
<li>反编译源码，查找泄露信息，提取接口、JS逆向签名、加密算法等信息。</li>
</ul>
<h2 id="APP信息"><a href="#APP信息" class="headerlink" title="APP信息"></a>APP信息</h2><h3 id="外在"><a href="#外在" class="headerlink" title="外在"></a>外在</h3><ul>
<li>使用安卓模拟器和 <strong>Burp Suite</strong> 抓包工具分析Web资产，重复信息收集步骤。</li>
</ul>
<h3 id="内在"><a href="#内在" class="headerlink" title="内在"></a>内在</h3><ul>
<li><strong>查壳工具</strong> 查找壳（<a target="_blank" rel="noopener" href="https://github.com/itsmenaga/apkscan">apkscan</a>）</li>
<li><strong>安卓信息提取器</strong>（<a target="_blank" rel="noopener" href="https://github.com/kelvinBen/AppInfoScanner">AppInfoScanner</a>）</li>
<li><strong>安卓修改大师</strong>（<a target="_blank" rel="noopener" href="https://www.apkeditor.cn/">APKEditor</a>）进行反编译</li>
</ul>
<p>信息收集是灵活的，不必局限于某一固定的思路。关键是学习如何通过一层层剥茧收集目标信息，分析他人收集信息的思维方式，而不仅仅是手段。</p>
<blockquote>
<p>本文略讲了信息收集的冰山一角，侧重点在资产发现与扩展和整理上，重点资产针对性深度收集部分比较简略。但其实信息搜集的艺术远不止此，笔者也技术浅薄，仍需多多学习，如有不对之处还请师傅们斧正！</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://x1lys.github.io">X1ly?S</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://x1lys.github.io/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/">https://x1lys.github.io/2024/12/12/万字长文窥探信息收集真正的艺术/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://x1lys.github.io" target="_blank">X1ly?S</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>技术交流，互相学习</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://wpa.qq.com/msgrd?v=3&amp;uin=2382247834&amp;site=qq&amp;menu=yes" target="_blank"><img class="post-qr-code-img" src="/img/52.jpg" alt="联系我"/></a><div class="post-qr-code-desc">联系我</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/28/2024-%E9%95%BF%E4%BA%AD%E6%A0%A1%E6%8B%9B-%E5%AE%89%E6%9C%8D%E7%BB%8F%E9%AA%8C%E6%B5%85%E8%B0%88/" title="2024-长亭校招-安服经验浅谈"><img class="cover" src="/img/1.jpg" onerror="onerror=null;src='/img/18.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">2024-长亭校招-安服经验浅谈</div></div><div class="info-2"><div class="info-item-1">前言最近趁着期末周，考试也考得差不多了，有点小空，于是笔者去面试了长亭校招安服岗，不过由于我现在大二在读，于是只能去实习，不过技术面试应该还是按照校招的标准来的吧，因为我看到面试官给我标注的是校招，于是这些面经还算有点参考价值。两次技术面试，加一次HR三面，第一次技术面准备了几个小时，准备了自我介绍和复盘了一下自己挖到过的比较精彩的漏洞案例，很顺利就通过了，该回答的问题基本都回答得还行，个别问题还刚好是我准备过的问题，就回答得比较”巴适”。第二次技术面，想着可能会上强度，本打算早起好好准备一下的，结果睡过头了，密码，直接睡到下午2点，刚好距离面试还有1个小时！卧槽，害只能硬上了，结果也还行，也是当场就过了，接下来就是两位面试官问我的问题，一面应该是安全部门负责人面的，二面是交叉面试官，不知道是哪个部门……  技术一面 自我介绍一下吧 sql注入的原理 在php与java上的代码体现？ 二次注入的原理? 任意文件读取漏洞在实战中具体是怎么危害最大化的 文件上传漏洞怎么绕WAF？ 文件上传...</div></div></div></a><a class="pagination-related" href="/2024/12/07/%E6%B7%B1%E5%BA%A6%E5%88%A9%E7%94%A8Github%E5%AF%BB%E6%89%BE%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF/" title="深度利用Github寻找敏感信息"><img class="cover" src="/img/1.jpg" onerror="onerror=null;src='/img/18.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">深度利用Github寻找敏感信息</div></div><div class="info-2"><div class="info-item-1">深度利用Github寻找敏感信息 前言：水一篇文章，没啥技术含量，会用就行  Github语法利用Github语法检索敏感信息 1234567891011121314151617181920212223242526272829303132333435363738in:name test			  #仓库标题搜索含有关键字in:descripton test         #仓库描述搜索含有关键字in:readme test             #Readme文件搜素含有关键字stars:&gt;3000 test           #stars数量大于3000的搜索关键字stars:1000..3000 test      #stars数量大于1000小于3000的搜索关键字forks:&gt;1000 test           #forks数量大于1000的搜索关键字forks:1000..3000 test      #forks数量大于1000小于3000的搜索关键字size:&gt;=5000 test          ...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/11.jpg" onerror="this.onerror=null;this.src='/img/47.jpg'" alt="avatar"/></div><div class="author-info-name">X1ly?S</div><div class="author-info-description">需要的不是掌声，而是没有哭声</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">109</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/x1lys" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2382247834@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://wpa.qq.com/msgrd?v=3&amp;uin=2382247834&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq" style="color: #00b7f1;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">更多优质技术文章，欢迎关注【The One安全】微信公众号</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B6%E9%9B%86%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">收集流程概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">自动化信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84%E6%94%B6%E9%9B%86"><span class="toc-number">4.</span> <span class="toc-text">组织结构收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E9%9B%86%E6%96%B9%E6%B3%95"><span class="toc-number">4.3.</span> <span class="toc-text">收集方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%82%A1%E6%9D%83%E6%94%B6%E9%9B%86%E6%B3%95"><span class="toc-number">4.3.1.</span> <span class="toc-text">股权收集法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E4%BA%BA%E7%89%A9%E6%94%B6%E9%9B%86%E6%B3%95"><span class="toc-number">4.3.2.</span> <span class="toc-text">关键人物收集法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-number">4.4.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86"><span class="toc-number">5.</span> <span class="toc-text">主域名收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ICP%E5%A4%87%E6%A1%88"><span class="toc-number">5.1.</span> <span class="toc-text">ICP备案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.1.1.</span> <span class="toc-text">官网查询接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.1.2.</span> <span class="toc-text">第三方程序查询接口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E8%93%9D%E6%9C%AC"><span class="toc-number">5.2.</span> <span class="toc-text">小蓝本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-1"><span class="toc-number">5.3.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86"><span class="toc-number">6.</span> <span class="toc-text">子域名收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%B5%8B%E7%BB%98%E5%BC%95%E6%93%8E"><span class="toc-number">6.1.</span> <span class="toc-text">网络测绘引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E8%AF%AD%E6%B3%95"><span class="toc-number">6.1.1.</span> <span class="toc-text">综合语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F"><span class="toc-number">6.1.2.</span> <span class="toc-text">批量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-join-py"><span class="toc-number">6.1.2.1.</span> <span class="toc-text">脚本-join.py</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">6.1.3.</span> <span class="toc-text">注意</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#all%E6%A8%A1%E5%BC%8F%E5%BC%80%E5%90%AF"><span class="toc-number">6.1.3.1.</span> <span class="toc-text">all模式开启</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">6.1.4.</span> <span class="toc-text">格式处理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-format-py"><span class="toc-number">6.1.4.1.</span> <span class="toc-text">脚本-format.py</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8B%B1%E6%96%87%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.2.</span> <span class="toc-text">英文证书查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F"><span class="toc-number">6.2.1.</span> <span class="toc-text">查询方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#q%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.2.1.1.</span> <span class="toc-text">q模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#o%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.2.1.2.</span> <span class="toc-text">o模式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F-1"><span class="toc-number">6.2.2.</span> <span class="toc-text">批量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-crt-sh-py"><span class="toc-number">6.2.2.1.</span> <span class="toc-text">脚本-crt.sh.py</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86-1"><span class="toc-number">6.2.3.</span> <span class="toc-text">格式处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oneforall"><span class="toc-number">6.3.</span> <span class="toc-text">oneforall</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86-2"><span class="toc-number">6.3.1.</span> <span class="toc-text">格式处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E9%87%8D"><span class="toc-number">6.4.</span> <span class="toc-text">去重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-2"><span class="toc-number">6.5.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%94%B6%E9%9B%86"><span class="toc-number">7.</span> <span class="toc-text">端口收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-3"><span class="toc-number">7.1.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C%E6%AE%B5%E6%94%B6%E9%9B%86"><span class="toc-number">8.</span> <span class="toc-text">C段收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-4"><span class="toc-number">8.1.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HOST%E7%A2%B0%E6%92%9E"><span class="toc-number">9.</span> <span class="toc-text">HOST碰撞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC-domain-auth-py"><span class="toc-number">9.0.0.1.</span> <span class="toc-text">脚本-domain_auth.py</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-5"><span class="toc-number">9.1.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E6%B4%BB-%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB"><span class="toc-number">10.</span> <span class="toc-text">测活+指纹识别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%9A%E6%9C%ACipadd-py"><span class="toc-number">10.0.0.1.</span> <span class="toc-text">脚本ipadd.py</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-6"><span class="toc-number">10.1.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%AB%E6%8F%8F"><span class="toc-number">11.</span> <span class="toc-text">自动化扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E4%BF%A1%E6%81%AF"><span class="toc-number">12.</span> <span class="toc-text">架构信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">12.1.</span> <span class="toc-text">反向代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">12.2.</span> <span class="toc-text">负载均衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%99%E5%BA%93%E5%88%86%E7%A6%BB"><span class="toc-number">12.3.</span> <span class="toc-text">站库分离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN"><span class="toc-number">12.4.</span> <span class="toc-text">CDN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WAF%EF%BC%88Web-Application-Firewall%EF%BC%89"><span class="toc-number">12.5.</span> <span class="toc-text">WAF（Web Application Firewall）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E4%BF%A1%E6%81%AF"><span class="toc-number">13.</span> <span class="toc-text">源码信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CMS%EF%BC%88%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-number">13.1.</span> <span class="toc-text">CMS（内容管理系统）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AD%E6%BA%90%E5%94%AE%E5%8D%96"><span class="toc-number">13.2.</span> <span class="toc-text">闭源售卖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2"><span class="toc-number">13.3.</span> <span class="toc-text">泄露</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">14.</span> <span class="toc-text">网站基本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E8%A8%80"><span class="toc-number">14.1.</span> <span class="toc-text">语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">14.2.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E5%AE%B9%E5%99%A8"><span class="toc-number">14.3.</span> <span class="toc-text">web容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">14.4.</span> <span class="toc-text">操作系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E6%B7%B1%E5%BA%A6%E4%BF%A1%E6%81%AF"><span class="toc-number">15.</span> <span class="toc-text">网站深度信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">15.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E6%8E%A5%E5%8F%A3"><span class="toc-number">15.2.</span> <span class="toc-text">JS接口</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#downloadjs-py"><span class="toc-number">15.2.0.1.</span> <span class="toc-text">downloadjs.py</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#findapi-py"><span class="toc-number">15.2.0.2.</span> <span class="toc-text">findapi.py</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E7%85%A7"><span class="toc-number">15.3.</span> <span class="toc-text">快照</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">15.4.</span> <span class="toc-text">插件信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%A5%E5%8F%A3%E4%BF%A1%E6%81%AF"><span class="toc-number">15.5.</span> <span class="toc-text">第三方接口信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%81%E7%AB%99"><span class="toc-number">15.6.</span> <span class="toc-text">旁站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%9C%8D%E5%8A%A1"><span class="toc-number">15.7.</span> <span class="toc-text">端口服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%9B%98%E4%BF%A1%E6%81%AF"><span class="toc-number">16.</span> <span class="toc-text">网盘信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7-7"><span class="toc-number">16.1.</span> <span class="toc-text">工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E5%B7%A5%E4%BF%A1%E6%81%AF"><span class="toc-number">17.</span> <span class="toc-text">社工信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BF%A1%E6%81%AF"><span class="toc-number">18.</span> <span class="toc-text">小程序信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APP%E4%BF%A1%E6%81%AF"><span class="toc-number">19.</span> <span class="toc-text">APP信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E5%9C%A8"><span class="toc-number">19.1.</span> <span class="toc-text">外在</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%9C%A8"><span class="toc-number">19.2.</span> <span class="toc-text">内在</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-2/" title="java安全漫谈-反序列化-2"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/18.jpg'" alt="java安全漫谈-反序列化-2"/></a><div class="content"><a class="title" href="/2025/12/01/7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-2/" title="java安全漫谈-反序列化-2">java安全漫谈-反序列化-2</a><time datetime="2025-12-01T14:32:59.000Z" title="发表于 2025-12-01 22:32:59">2025-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1/" title="java安全漫谈-反序列化-1"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/18.jpg'" alt="java安全漫谈-反序列化-1"/></a><div class="content"><a class="title" href="/2025/12/01/7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1/" title="java安全漫谈-反序列化-1">java安全漫谈-反序列化-1</a><time datetime="2025-12-01T14:32:56.000Z" title="发表于 2025-12-01 22:32:56">2025-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/6-RMI-3/" title="java安全漫谈-RMI-3"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/18.jpg'" alt="java安全漫谈-RMI-3"/></a><div class="content"><a class="title" href="/2025/12/01/6-RMI-3/" title="java安全漫谈-RMI-3">java安全漫谈-RMI-3</a><time datetime="2025-12-01T14:32:45.000Z" title="发表于 2025-12-01 22:32:45">2025-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/5-RMI-2/" title="java安全漫谈-RMI-2"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/18.jpg'" alt="java安全漫谈-RMI-2"/></a><div class="content"><a class="title" href="/2025/12/01/5-RMI-2/" title="java安全漫谈-RMI-2">java安全漫谈-RMI-2</a><time datetime="2025-12-01T14:32:40.000Z" title="发表于 2025-12-01 22:32:40">2025-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/01/4-RMI1/" title="java安全漫谈-RMI-1"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/18.jpg'" alt="java安全漫谈-RMI-1"/></a><div class="content"><a class="title" href="/2025/12/01/4-RMI1/" title="java安全漫谈-RMI-1">java安全漫谈-RMI-1</a><time datetime="2025-12-01T14:32:31.000Z" title="发表于 2025-12-01 22:32:31">2025-12-01</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/1.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By X1ly?S</div><div class="footer_custom_text">我的来时路</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://comments-swart.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: true,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script>(() => {
  const isChatBtn = false
  const isChatHideShow = false

  if (isChatBtn) {
    const close = () => {
      Chatra('minimizeWidget')
      Chatra('hide')
    }

    const open = () => {
      Chatra('openChat', true)
      Chatra('show')
    }

    window.ChatraSetup = { startHidden: true }
  
    window.chatBtnFn = () => {
      document.getElementById('chatra').classList.contains('chatra--expanded') ? close() : open()
    }
  } else if (isChatHideShow) {
    window.chatBtn = {
      hide: () => Chatra('hide'),
      show: () => Chatra('show')
    }
  }

  (function(d, w, c) {
    w.ChatraID = ''
    var s = d.createElement('script')
    w[c] = w[c] || function() {
      (w[c].q = w[c].q || []).push(arguments)
    }
    s.async = true
    s.src = 'https://call.chatra.io/chatra.js'
    if (d.head) d.head.appendChild(s)
  })(document, window, 'Chatra')
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>